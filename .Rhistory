install.packages("ggplot2")
install.packages(c("car", "d3Network", "devtools", "dplyr", "dunn.test", "fifer", "foreign", "psych", "ggnetwork", "ggthemes", "knitr", "NLP", "pander", "plyr", "RColorBrewer", "reshape2", "shiny", "scales", "scholar", "SnowballC", "stats"))
install.packages(c("car", "d3Network", "devtools", "dplyr", "dunn.test",
install.packages(c("car", "d3Network", "devtools", "dplyr", "dunn.test", "fifer", "foreign", "psych", "ggnetwork", "ggthemes", "knitr", "NLP", "pander", "plyr", "RColorBrewer", "reshape2", "shiny", "scales", "scholar", "SnowballC", "stats"))
install.packages(c("car", "d3Network", "devtools", "dplyr", "dunn.test",
install.packages(c("car", "d3Network", "devtools", "dplyr", "dunn.test", "fifer", "foreign", "psych", "ggnetwork", "ggthemes", "knitr", "NLP", "pander", "plyr", "RColorBrewer", "reshape2", "shiny", "scales", "scholar", "SnowballC", "stats"))
install.packages(c("car", "d3Network", "devtools", "dplyr", "dunn.test",
)
install.packages("car")
install.packages("d3Network")
install.packages(c(devtools", "dplyr", "dunn.test"))
install.packages(c("devtools", "dplyr", "dunn.test"))
install.packages(c("dplyr", "dunn.test", "fifer"))
install.packages(c("foreign", "psych", "ggnetwork", "ggthemes", "knitr", "NLP", "pander", "plyr", "RColorBrewer", "reshape2", "shiny", "scales", "scholar", "SnowballC", "stats"))
install.packages(c("foreign", "psych", "ggnetwork", "ggthemes",
install.packages(c("foreign", "psych", "ggnetwork"))
install.packages(c("ggthemes", "knitr", "NLP"))
install.packages(c("pander", "plyr", "reshape2", "shiny", "scales", "scholar", "SnowballC", "stats"))
install.packages(c("pander", "plyr", "shiny", "scales", "scholar", "SnowballC", "stats"))
install.packages(c("pander", "plyr", "shiny", "scales", "scholar", "SnowballC"))
setwd("~/Documents/Github/Info813")
library(foreign)
library(cluster)
library(fpc)
library(clValid)
data <- read.spss("org_dissim.sav")
output <- matrix(unlist(data), ncol = 31)
colnames(output) <- c("", "o1", "o2", "o3", "o4", "o5", "o6", "o7", "o8", "o9", "o10", "o11", "o12", "o13", "o14", "o15", "o16", "o17", "o18", "o19", "o20", "o21", "o22", "o23", "o24", "o25", "o26", "o27", "o28", "o29", "o30")
output <- output[,-1]
output
output[1:5, 1:5]
heatmap(output)
?heatmap
heatpmap(output)
heatmap(output)
?heatmap
?cluster
?dist
org.hclust = hclust(org.dist)
plot(org.hclust)
org.dist <- dist(output, method = "euclidean")
org.hclust = hclust(org.dist)
plot(org.hclust)
scatterplot(output)
plot(output)
pairs(output)
pairs(~o1 + o2 + o3 + o4, data = output)
pairs(~o5 + o6 + o7 + o8, data = output)
par(mfrow = (2, 3))
pairs(~o1 + o2 + o3 + o4 + o5, data= output)
pairs(~o6 + o7 + o8 + o9 + o10, data= output)
pairs(~o11 + o12 + o13 + o14 + o15, data= output)
pairs(~o16 + o17 + o18 + o19 + o20, data= output)
pairs(~o21 + o22 + o23 + o24 + o25, data= output)
pairs(~o26 + o27 + o28 + o29 + o30, data= output)
par(mfrow = c(2, 3))
pairs(~o1 + o2 + o3 + o4 + o5, data= output)
pairs(~o6 + o7 + o8 + o9 + o10, data= output)
pairs(~o11 + o12 + o13 + o14 + o15, data= output)
pairs(~o16 + o17 + o18 + o19 + o20, data= output)
pairs(~o21 + o22 + o23 + o24 + o25, data= output)
pairs(~o26 + o27 + o28 + o29 + o30, data= output)
pairs(~o1 + o2 + o3 + o4 + o5, data= output)
pairs(~o6 + o7 + o8 + o9 + o10, data= output)
pairs(~o11 + o12 + o13 + o14 + o15, data= output)
pairs(~o16 + o17 + o18 + o19 + o20, data= output)
pairs(~o21 + o22 + o23 + o24 + o25, data= output)
pairs(~o26 + o27 + o28 + o29 + o30, data= output)
pairs(~o6 + o7 + o8 + o9 + o10, data= output)
pairs(~o11 + o12 + o13 + o14 + o15, data= output)
pairs(~o16 + o17 + o18 + o19 + o20, data= output)
pairs(~o21 + o22 + o23 + o24 + o25, data= output)
pairs(~o26 + o27 + o28 + o29 + o30, data= output)
pairs(~o1 + o2 + o3 + o4 + o5, data= output)
org.hclust = hclust(org.dist)
plot(org.hclust)
org.hclust = hclust(org.dist)
plot(org.hclust)
heatmap(output)
## Agglomerative
org.hclust = hclust(org.dist)
plot(org.hclust)
## Agglomerative
org.hclust = hclust(org.dist)
plot(org.hclust)
rect.hclust(org.hclust, k = 3)
fit <- kmeans(org.dist, 3)
clusplot(output, fit$cluster)
aggregate(output, by = list(fit$cluster), FUN = mean)
fit
fit <- kmeans(output, 3)
clusplot(output, fit$cluster)
aggregate(output, by = list(fit$cluster), FUN = mean)
org.dist <- dist(output, method = "euclidean")
## Agglomerative
org.hclust = hclust(org.dist)
plot(org.hclust)
rect.hclust(org.hclust, k = 3)
## Partitioning
fit <- kmeans(output, 3)
clusplot(output, fit$cluster)
aggregate(output, by = list(fit$cluster), FUN = mean)
fit_2 <- kmeans(org.dist, 2)
clusplot(output, fit_2$cluster)
## PAM cluster
pam.2 <- pam(output, 2)
pam.3 <- pam(output, 3)
plot(pam.3)
group_3 <- cutree(org.hclust, 3)
group_2 <- cutree(org.hclust, 2)
table(group_2)
table(group_3)
cluster.stats(org.dist, group_2)
calinhara(org.dist, group_3)
calinhara(org.dist, group_2)
fit <- kmeans(output, 3)
clusplot(output, fit$cluster)
aggregate(output, by = list(fit$cluster), FUN = mean)
table(fit)
fit
summary(fit)
## Partitioning
fit <- kmeans(output, 3)
clusplot(output, fit$cluster, main = "K-mean plot")
aggregate(output, by = list(fit$cluster), FUN = mean)
## Agglomerative
org.hclust = hclust(org.dist)
plot(org.hclust)
rect.hclust(org.hclust, k = 3)
## Partitioning
fit <- kmeans(output, 3)
clusplot(output, fit$cluster, main = "K-mean plot")
pam.2 <- pam(output, 2)
plot(pam.2)
cluster.stats(org.dist, group_2)
## Agglomerative
org.hclust = hclust(org.dist)
plot(org.hclust)
rect.hclust(org.hclust, k = 2)
## Partitioning
par(fmrow = (1,2)
fit <- kmeans(output, 3)
fit_2 <- kmeans(output, 2)
clusplot(output, fit$cluster, main = "K-mean plot with 3 clusters")
clusplot(output, fit_2$cluster, main = "K-mean plot with 2 clusters")
## Partitioning
par(mfrow = c(1,2))
fit <- kmeans(output, 3)
fit_2 <- kmeans(output, 2)
clusplot(output, fit$cluster, main = "K-mean plot with 3 clusters")
clusplot(output, fit_2$cluster, main = "K-mean plot with 2 clusters")
## Partitioning
par(mfrow = c(2,1))
fit <- kmeans(output, 3)
fit_2 <- kmeans(output, 2)
clusplot(output, fit$cluster, main = "K-mean plot with 3 clusters")
clusplot(output, fit_2$cluster, main = "K-mean plot with 2 clusters")
group_3 <- cutree(org.hclust, 3)
group_2 <- cutree(org.hclust, 2)
table(group_2)
table(group_3)
library(pander)
f_table <- data.frame(c("2-cluster", "3-cluster"), c(f_2, f_3))
group_3 <- cutree(org.hclust, 3)
group_2 <- cutree(org.hclust, 2)
f_3 <- calinhara(org.dist, group_3)
f_2 <- calinhara(org.dist, group_2)
f_table <- data.frame(c("2-cluster", "3-cluster"), c(f_2, f_3))
group_3 <- cutree(org.hclust, 3)
group_2 <- cutree(org.hclust, 2)
f_3 <- calinhara(org.dist, group_3)
f_2 <- calinhara(org.dist, group_2)
f_table <- data.frame(c("2-cluster", "3-cluster"), c(f_2, f_3))
colnames(f_table) <- c("Solution", "pseudo-F value")
pander(f_table)
## PAM cluster
pam.2 <- pam(output, 2)
pam.3 <- pam(output, 3)
plot(pam.3)
plot(pam.2)
ï¼Ÿpam
?pam
pam.2
pam.2$clustering
group_2
pam.3$clustering
group_3
plot(pam.2)
plot(pam.2)
## PAM cluster
par(mfrow = c(2,1))
pam.2 <- pam(output, 2)
pam.3 <- pam(output, 3)
plot(pam.2)
plot(pam.3)
pam.2
pam.3$data
pam.2
pam.2$silinfo
pam.2$clus.avg.widths
pam.2$silinfo$clus.avg.widths
pam.2$silinfo$clus.avg.width
pam.2$silinfo$avg.width
## PAM cluster
par(mfrow = c(2,1))
pam.2 <- pam(output, 2)
pam.3 <- pam(output, 3)
sil_table <- data.frame(c("2-cluster", "3-cluster"), c(pam.2$silinfo$avg.width, pam.3$silinfo$avg.width))
colnames(sil_table) <- c("Solution", "Average sihouette width")
pander(sil_table)
update.packages("pam")
?pamk
?pamk
pamk(output, krange = 2:5)
clusplot(output, fit$cluster, main = "K-mean plot with 3 clusters")
group_3 <- cutree(org.hclust, 3)
group_2 <- cutree(org.hclust, 2)
group_4 <- cutree(org.hclust, 4)
f_3 <- calinhara(org.dist, group_3)
f_2 <- calinhara(org.dist, group_2)
f_4 <- calinhara(org.dist, group_4)
f_4
?calinhara
result <- pamk(output, krange = 2:5)
result
result$crit
result$crit[2]
sil_table <- data.frame(c("2-cluster", "3-cluster", "4-cluster, "5-cluster), c(result$crit[2], result$crit[3], result$crit[4], result$crit[5]))
colnames(sil_table) <- c("Solution", "Average sihouette width")
pander(sil_table)
result <- pamk(output, krange = 2:5)
sil_table <- data.frame(c("2-cluster", "3-cluster", "4-cluster, "5-cluster"), c(result$crit[2], result$crit[3], result$crit[4], result$crit[5]))
colnames(sil_table) <- c("Solution", "Average sihouette width")
pander(sil_table)
result <- pamk(output, krange = 2:5)
sil_table <- data.frame(c("2-cluster", "3-cluster", "4-cluster", "5-cluster"), c(result$crit[2], result$crit[3], result$crit[4], result$crit[5]))
colnames(sil_table) <- c("Solution", "Average sihouette width")
pander(sil_table)
group_3 <- cutree(org.hclust, 3)
group_2 <- cutree(org.hclust, 2)
group_4 <- cutree(org.hclust, 4)
group_5 <- cutree(org.hclust, 5)
f_3 <- calinhara(org.dist, group_3)
f_2 <- calinhara(org.dist, group_2)
f_4 <- calinhara(org.dist, group_4)
f_5 <- calinhara(org.dist, group_5)
f_table <- data.frame(c("2-cluster", "3-cluster", "4-cluster", "5-cluster"), c(f_2, f_3, f_4, f_5))
colnames(f_table) <- c("Solution", "pseudo-F value")
pander(f_table)
?fviz_silhouette
??fviz_silhouette
plot(result)
?pam
pam.3 <- pam(output, k = 3)
plot(pam.3, main = "Silhouette plot for 3-cluster solution")
pam.3 <- pam(output, k = 3)
plot(pam.3, main = "Silhouette plot for 3-cluster solution")
cluster.stats(dist)
cluster.stats(org.dist)
org.dist <- dist(output, method = "euclidean")
cluster.stats(org.dist)
cluster.stats(org.dist, clustering = 3)
?cluster.stats
cluster.stats(org.dist, 3)
cluster.stats(org.hclust, 3)
cluster.stats(fit, 3)
fit
fit$betweenss
fit$withinss
fit$tot.withinss
fit$totss
fit$size
fit$iter
fit$ifault
stats.2 <- cluster.stats(fit, 2)
stats.3 <- cluster.stats(fit, 3)
stats.4 <- cluster.stats(fit, 4)
stats.5 <- cluster.stats(fit, 5)
stat_table <- data.frame(c("2-cluster", "3-cluster", "4-cluster", "5-cluster"),
c(stats.2$betweenss / stats.2$totss, stats.3$betweenss / stats.3$totss, stats.4$betweenss / stats.4$totss, stats.5$betweenss / stats.5$totss))
colnames(stat_table) <- c("Solution", "Percentage of total variance")
pander(stat_table)
fit.4 <- kmeans(output, 4)
fit.5 <- kmeans(output, 5)
stat_table <- data.frame(c("2-cluster", "3-cluster", "4-cluster", "5-cluster"),
c(fit_2$betweenss / fit_2$totss, fit$betweenss / fit$totss, fit.4$betweenss / fit.4$totss, fit.5$betweenss / fit.5$totss))
colnames(stat_table) <- c("Solution", "Percentage of total variance")
pander(stat_table)
## PAM cluster
result <- pamk(output, krange = 2:5)
sil_table <- data.frame(c("2-cluster", "3-cluster", "4-cluster", "5-cluster"), c(result$crit[2], result$crit[3], result$crit[4], result$crit[5]))
colnames(sil_table) <- c("Solution", "Average sihouette width")
pander(sil_table)
